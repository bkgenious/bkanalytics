name: Publish Content

on:
  workflow_dispatch:
    inputs:
      message:
        description: 'Commit message'
        required: true
        default: 'Content update from CMS'

jobs:
  publish:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4
        with:
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Configure Git User
        run: |
          git config user.name "Portfolio CMS Bot"
          git config user.email "cms-bot@bkanalytics.in"

      - name: Add Content Changes
        run: |
          git add data/projects.json
          git add data/config.json || true
          git add public/uploads/
          git status

      - name: Commit and Push
        run: |
          git commit -m "${{ inputs.message }}" || echo "No changes to commit"
          git push origin main
